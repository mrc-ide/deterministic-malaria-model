<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Writing your own model • ICDMM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Writing your own model">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ICDMM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/run_model_example.html">Simplest Model Run</a>
    </li>
    <li>
      <a href="../articles/run_model.html">More Flexible Model Run</a>
    </li>
    <li>
      <a href="../articles/run_model_alternative.html">Alternative Model Runs</a>
    </li>
    <li>
      <a href="../articles/write_own_model.html">Writing Your Own Model</a>
    </li>
    <li>
      <a href="../articles/model_reference.html">Model Reference</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../CONTRIBUTING.html">Contributing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/deterministic-malaria-model" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Writing your own model</h1>
                        <h4 data-toc-skip class="author">Joel
Hellewell</h4>
            
            <h4 data-toc-skip class="date">2025-02-05</h4>
      

      <div class="hidden name"><code>write_own_model.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>You might want to write your own extension to the malaria models, in
this vignette I will try and cover the easiest way of doing this.</p>
<p>You should start by cloning this github repository to your own
computer. If you are new to R package development the next best step is
to open the <code>ICDMM.Rproj</code> file using RStudio.</p>
</div>
<div class="section level2">
<h2 id="adding-your-own-odin-model">Adding your own odin model<a class="anchor" aria-label="anchor" href="#adding-your-own-odin-model"></a>
</h2>
<p>If you write some new code in a file called
<code>example_model.R</code>, you should save it in
<code>inst/odin</code> with the other models. You then need to run
<code><a href="https://rdrr.io/pkg/odin/man/odin_package.html" class="external-link">odin::odin_package()</a></code>, with the directory path of the
project inside the parenthesis, this will add a compiled version of your
odin model to the package files.</p>
</div>
<div class="section level2">
<h2 id="other-code-changes">Other code changes<a class="anchor" aria-label="anchor" href="#other-code-changes"></a>
</h2>
<p>You will need to add your model name to the following bit of code in
line 44 of <code>R/run_model.R</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">generator</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>    <span class="st">"odin_model"</span> <span class="op">=</span> <span class="va">odin_model</span>,</span>
<span>    <span class="st">"odin_model_emanators"</span> <span class="op">=</span> <span class="va">odin_model_emanators</span>,</span>
<span>    <span class="st">"odin_model_hrp2"</span> <span class="op">=</span> <span class="va">odin_model_hrp2</span>,</span>
<span>    <span class="st">"odin_model_IVM_SMChet"</span> <span class="op">=</span> <span class="va">odin_model_IVM_SMChet</span>,</span>
<span>    <span class="st">"example"</span> <span class="op">=</span> <span class="va">example</span>,</span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Unknown model '%s'"</span>, <span class="va">model</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This will allow for you to eventually run
<code>run_model(model = "example")</code> to run your odin model.</p>
</div>
<div class="section level2">
<h2 id="rebuild-package">Rebuild package<a class="anchor" aria-label="anchor" href="#rebuild-package"></a>
</h2>
<p>The final step is to rebuild the R package, you can do this by
pressing “Install and Restart” in the “Build” panel in RStudio (usually
in the top right panels) or the usual keyboard is ctrl + shift + b (or
cmd + shift + b on a mac)</p>
</div>
<div class="section level2">
<h2 id="working-with-github">Working with github<a class="anchor" aria-label="anchor" href="#working-with-github"></a>
</h2>
<p>The easiest way to develop your new package using github will be to
make a new branch. You can do this using the “New Branch” button in the
RStudio interface or by running
<code>git checkout -b &lt;branch name&gt;</code>. You can then push this
new branch to github to do version control but your changes won’t affect
anything on the main branch. When you have finished working on your
model you can use github to create a pull request and we can merge it
with the main branch so that everyone downloading the package also
recieves your model as part of it.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joel Hellewell, Hannah Slater, Juliette Unwin, OJ Watson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
